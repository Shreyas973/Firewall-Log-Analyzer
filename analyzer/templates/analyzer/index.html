<html>
<head><title>Firewall Log Analyzer</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; background-color: #f38585ff; }
h1 { color: #333;text-align: center; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
th { background-color: #f4f4f4; }
ul { list-style-type: none; padding: 0; }
li { margin: 5px 0; }
</style>




</head>
    

<body>
<h1>Firewall Log Analyzer</h1>
<h3>Stats</h3>
<p>Total: {{ stats.total }} | ALLOW: {{ stats.allows }} | DENY: {{ stats.denies }}</p>
<h3>Recent Alerts</h3>
<ul>{% for a in alerts %}<li>[{{ a.level }}] {{ a.message }}</li>{% empty %}<li>No alerts</li>{% endfor %}</ul>
<h3>Recent Logs</h3>
<table border=1>{% for e in latest %}<tr><td>{{ e.timestamp }}</td><td>{{ e.action }}</td><td>{{ e.src_ip }}</td><td>{{ e.dst_ip }}</td><td>{{ e.dst_port }}</td></tr>{% empty %}<tr><td colspan=5>No entries</td></tr>{% endfor %}</table>
</body></html>
